---
title: "Time Series Midterm DS6373-403"
author: "Steve Bramhall"
date: "June 29, 2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tswge)
library(stats)
library(tidyverse)
```

```{r Prob1}
x=c(6,8,13,12,10,7,4,2,1)
gamma0=var(x)*((length(x)-1)/length(x))
```

```{r Prob2}
autocorr=acf(x,lag.max=length(x)-1)
autocorr
```

```{r Prob3}
# counted x0,X3 x1,x4 x2,x5 x3,x6 x4,x7 x5,x8 
# 6 pairs
```

```{r Prob4}
# for rho7: 1,8 2,6 
```

```{r Prob5}
# (1-.6B+.4B^2)
psi.weights.wge(phi=c(.6,-.4),lag.max=length(x)-1)

x=gen.arma.wge(n=100,phi=-.5,sn=7)
plotts.true.wge(n=100,phi=-.5)
```



```{r}

# (1-.4B+.6B^2-.8B^3)(X_t-9)=a_t
psi.weights.wge(phi=c(.4,-.6,.8),lag.max = 5)

# arma forecast with CV
data = read.csv(file='',header=TRUE)  # load files
plotts.wge(data$col)                  # plot data
arma1 = fore.armu.wge(data$col,phi=c(),n.ahead=39,lastn=T,limits=F)
aramASE1 = mean((arama1$f - data$col[69:99])^2)

# aruma forecst with cv
# (B)(1-B^12)(X_t - u) = a_t
# flat, last value, no trend
aruma1=fore.aruma.wge(data2=0,s=12,phi=c(.74,0,0,0,0,0,0,0,0,0,0,.38,-.2812),n.ahead=36,lastn=T,limits=F)
arumaASE1 = mean((arama1$f - data$col[69:99])^2)

# signal plus noise forecast with CV
sgdata=gen.sigplusnoise.wge(n=50,b0=10,b1=.2,phi=c(.8,-.6))
sg1=fore.sigplusnoise.wge(sgdata,linear=T,n.ahead=20,lastn=F,limits=F)
sg1ASE1 = mean((sgdata$f - sgdata[xx,xx])^2)


```


Half Widths
```{r For Live Session}
x=c(5,8,9,8,7,6,4,3)
mult.wge(.9,.8)
sdx=sd(x)
psiw=psi.weights.wge(phi=c(1.7,-.72),lag.max = 5)
fore.aruma.wge(x,phi=c(1.7,-.72),n.ahead=3,plot=T,limits=T)
psiw0=1;
halfw1=1.96*sdx*((psiw0^2)^.5)
halfw2=1.96*sdx*(((psiw0^2)+(psiw[1]^2))^.5)
halfw3=1.96*sdx*(((psiw0^2)+(psiw[1]^2)+(psiw[2]^2))^.5)
halfw1
halfw2
halfw3
```

```{r}
factor.wge(phi=c(-.1,.3))
x=gen.arma.wge(n=100,phi=c(-.1,.3))
plotts.sample.wge(x)
```

```{r p1}
x = c(6, 8, 13, 12, 10, 7, 4, 2, 1)
mean(x)
n=9
gamma0=var(x)*(n-1)/n 
n=5
gamma0 = var(x)*(n-1)/n
paste("pred yo =", gamma0)
aut=acf(x,lag.max=n-1,plot=FALSE)
aut
psiw=psi.weights.wge(phi=c(.6,-.4),lag.max = 5)
psiw
f=fore.aruma.wge(x,phi=c(.6,-.4),n.ahead=3,plot=T,limits=T)
f$wnv^2
```

```{r}
data(global.temp)
plot(global.temp)
gt=global.temp[100:length(global.temp)]
length(gt)
sign=fore.sigplusnoise.wge(gt,linear=T,n.ahead=10,lastn=T,limits=F)
ASE1 = mean((sign$f-gt[51:60])^2)
ASE1

mod2=gen.aruma.wge(n=60,phi=c(-.62,.06,-.31),d=1,theta=c(-.17,-.75))
mod2b=artrans.wge(mod2,c(1))
mod2c=fore.aruma.wge(mod2b,phi=c(-.62,.06,-.31),d=1,theta=c(-.17,-.75),n.ahead=20,limits=T)

ASE2 = mean((mod2c$f-gt[51:60])^2)
ASE2

```

